import{Ac as h,Dc as j,Ec as M,S as y,U as d,aa as l,c as a,g as m,ja as D,la as b,ra as w,ta as x,ua as v}from"./chunk-5RIN4TRP.js";import{a as g,b as p}from"./chunk-FBFWB55K.js";function E(t){t||(t=l(b));let r=new a(e=>{if(t.destroyed){e.next();return}return t.onDestroy(e.next.bind(e))});return e=>e.pipe(y(r))}function U(t){let r=h(t);return new a(e=>{let n=r?.onDestroy(()=>e.complete()),i=t.subscribe(o=>e.next(o));return()=>{i.unsubscribe(),n?.()}})}function T(t,r){let e=r?.injector??l(D),n=new m(1),i=x(()=>{let o;try{o=t()}catch(u){v(()=>n.error(u));return}v(()=>n.next(o))},{injector:e,manualCleanup:!0});return e.get(b).onDestroy(()=>{i.destroy(),n.complete()}),n.asObservable()}function F(t){return j(p(g({},t),{loader:void 0,stream:r=>{let e,n=()=>e?.unsubscribe();r.abortSignal.addEventListener("abort",n);let i=w({value:void 0}),o,u=new Promise(s=>o=s);function c(s){i.set(s),o?.(i),o=void 0}let f=t.stream??t.loader;if(f===void 0)throw new d(990,!1);return e=f(r).subscribe({next:s=>c({value:s}),error:s=>{c({error:M(s)}),r.abortSignal.removeEventListener("abort",n)},complete:()=>{o&&c({error:new d(991,!1)}),r.abortSignal.removeEventListener("abort",n)}}),u}}))}export{E as a,U as b,T as c,F as d};
