import{c as T,d as F}from"./chunk-SSB7PWM5.js";import{g as I}from"./chunk-RHLQONDS.js";import{$ as n,Fc as a,Gc as v,N as u,W as f,Z as s,i as p,ja as l,mb as m,nb as c,ra as h,sa as g}from"./chunk-DNDEVHQ3.js";var E=new s("NXT_HIGHLIGHT_FILE_LOCATION",{providedIn:"root",factory:G});function G(){let t=n(l)?.location,d=n(I,{optional:!0})?.replace(/\/+$/igm,"");return{formatPathname:e=>{let i=(t?t.origin:"").replace(/\/+$/igm,"");if(e.startsWith("/"))return i+e;let o=d??i;return o&&(o+="/"),o+e}}}function y(t){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!]))?/.test(t)}var O=new s("NXT_GIST_OPTIONS");var D=(()=>{class t{constructor(){this.http=n(F),this.options=n(O,{optional:!0})}getCodeFromGist(e){let i;return this.options?.clientId&&this.options?.clientSecret&&(i=new T().set("client_id",this.options.clientId).set("client_secret",this.options.clientSecret)),this.fetchFile(`https://api.github.com/gists/${e}`,{params:i,responseType:"json"})}getCodeFromUrl(e){return this.fetchFile(e,{responseType:"text"})}fetchFile(e,i){return y(e)?this.http.get(e,i).pipe(u(1)):p}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=f({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),A=(()=>{class t{constructor(){this.location=n(E),this.loader=n(D)}transform(e){return this.loader.getCodeFromUrl(y(e)?e:this.location.formatPathname(e))}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275pipe=c({name:"codeFromUrl",type:t,pure:!0})}}return t})(),U=(()=>{class t{constructor(){this.loader=n(D),this.pendingTasks=n(h),this.gist=v(void 0,{alias:"nxtGist"}),this.gistLoad=a(),this.gistError=a(),g(e=>{let i=this.gist();if(i){let o=this.pendingTasks.add(),M=this.loader.getCodeFromGist(i).subscribe({next:r=>{this.gistLoad.emit(r),o()},error:r=>{this.gistError.emit(r),o()}});e(()=>{M.unsubscribe(),o()})}})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275dir=m({type:t,selectors:[["","nxtGist",""]],inputs:{gist:[1,"nxtGist","gist"]},outputs:{gistLoad:"gistLoad",gistError:"gistError"}})}}return t})(),k=(()=>{class t{transform(e,i){if(i)return e?.files?.[i]}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275pipe=c({name:"gistFile",type:t,pure:!0})}}return t})();export{A as a,U as b,k as c};
